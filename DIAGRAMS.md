# ğŸ“Š Diagramas de Arquitectura TravelBrain

## Diagrama General del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚                      ğŸ‘¤ USUARIO FINAL                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP (Navegador)
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚                     ğŸ¨ FRONTEND (React)                         â”‚
â”‚                      Puerto: 5173                               â”‚
â”‚                                                                 â”‚
â”‚  â€¢ Interfaz de usuario                                          â”‚
â”‚  â€¢ GestiÃ³n de estado (localStorage)                            â”‚
â”‚  â€¢ Formularios y validaciÃ³n bÃ¡sica                             â”‚
â”‚  â€¢ VisualizaciÃ³n de datos                                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ REST API Calls
                            â”‚ axios requests
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚                    ğŸ”§ BACKEND API                               â”‚
â”‚                    (Node.js + Express)                          â”‚
â”‚                      Puerto: 3004                               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Controladores                                            â”‚  â”‚
â”‚  â”‚ â€¢ authController    â€¢ tripController                     â”‚  â”‚
â”‚  â”‚ â€¢ userController    â€¢ destinationController              â”‚  â”‚
â”‚  â”‚ â€¢ itineraryController â€¢ weatherController                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Servicios              â”‚                                 â”‚  â”‚
â”‚  â”‚ â€¢ businessRulesClient  â—„â”€â”€â”€ Cliente HTTP (axios)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Base de Datos (MongoDB)                                  â”‚  â”‚
â”‚  â”‚ â€¢ Users    â€¢ Trips    â€¢ Destinations                     â”‚  â”‚
â”‚  â”‚ â€¢ Routes   â€¢ Itineraries â€¢ Weather                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                â”‚
                â”‚ Validaciones                   â”‚ APIs Externas
                â”‚ POST requests                  â”‚
                â”‚                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚      â”‚                              â”‚
â”‚  ğŸ§  BUSINESS RULES API   â”‚      â”‚  ğŸŒ SERVICIOS EXTERNOS       â”‚
â”‚  (Node.js + Express)     â”‚      â”‚                              â”‚
â”‚    Puerto: 3005          â”‚      â”‚  â€¢ OpenWeather API           â”‚
â”‚                          â”‚      â”‚  â€¢ Google OAuth              â”‚
â”‚  â€¢ Validaciones          â”‚      â”‚  â€¢ Mapbox                    â”‚
â”‚  â€¢ CÃ¡lculos              â”‚      â”‚                              â”‚
â”‚  â€¢ Reglas de negocio     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â€¢ GeneraciÃ³n datos      â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de CreaciÃ³n de Viaje

```
â”Œâ”€â”€â”€â”€â”€â”€â”    1. Llenar formulario
â”‚ USER â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
                                            â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   FRONTEND   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 2. POST /api/trips
                                           â”‚    {userId, title, destination, 
                                           â”‚     startDate, endDate, budget}
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   BACKEND    â”‚
                                    â”‚   API        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 3. Validar datos
                                           â”‚ POST /api/business-rules/
                                           â”‚      trips/validate-creation
                                           â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  BUSINESS RULES API    â”‚
                              â”‚                        â”‚
                              â”‚  Valida:               â”‚
                              â”‚  âœ“ userId obligatorio  â”‚
                              â”‚  âœ“ TÃ­tulo obligatorio  â”‚
                              â”‚  âœ“ Fechas vÃ¡lidas      â”‚
                              â”‚  âœ“ Budget â‰¥ 0          â”‚
                              â”‚  âœ“ Calcula duraciÃ³n    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 4. Respuesta validaciÃ³n
                                       â”‚    {valid: true, 
                                       â”‚     calculatedData: {...}}
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   BACKEND    â”‚
                                â”‚   API        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 5. Si vÃ¡lido â†’ Guardar en DB
                                       â”‚
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   MongoDB    â”‚
                                â”‚   (Trips)    â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 6. Viaje guardado
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   BACKEND    â”‚
                                â”‚   API        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 7. Respuesta con viaje creado
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   FRONTEND   â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 8. Mostrar confirmaciÃ³n
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚     USER     â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de GeneraciÃ³n de Itinerario

```
â”Œâ”€â”€â”€â”€â”€â”€â”    1. Solicitar itinerario
â”‚ USER â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
                                            â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   FRONTEND   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 2. POST /api/itineraries/generate
                                           â”‚    {tripId, interestType, budgetType}
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   BACKEND    â”‚
                                    â”‚   API        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 3. Obtener datos del viaje
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   MongoDB    â”‚
                                    â”‚   (Trips)    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 4. Datos del viaje
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   BACKEND    â”‚
                                    â”‚   API        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 5. Generar itinerario
                                           â”‚ POST /api/business-rules/
                                           â”‚      itineraries/generate
                                           â”‚    {tripData, interestType}
                                           â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  BUSINESS RULES API        â”‚
                              â”‚                            â”‚
                              â”‚  Procesa:                  â”‚
                              â”‚  1. Detecta tipo presup.   â”‚
                              â”‚  2. Calcula dÃ­as           â”‚
                              â”‚  3. Selecciona plantillas  â”‚
                              â”‚  4. Genera horarios        â”‚
                              â”‚  5. Calcula distribuciÃ³n   â”‚
                              â”‚                            â”‚
                              â”‚  Retorna:                  â”‚
                              â”‚  â€¢ dailyActivities         â”‚
                              â”‚  â€¢ budgetBreakdown         â”‚
                              â”‚  â€¢ budgetType              â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 6. Itinerario generado
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   BACKEND    â”‚
                                â”‚   API        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 7. Consultar clima
                                       â”‚    (OpenWeather API)
                                       â”‚
                                       â”‚ 8. Guardar itinerario completo
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   MongoDB    â”‚
                                â”‚(Itineraries) â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 9. Itinerario guardado
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   BACKEND    â”‚
                                â”‚   API        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 10. Respuesta con itinerario
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   FRONTEND   â”‚
                                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ 11. Mostrar itinerario
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚     USER     â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Arquitectura de Business Rules API

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BUSINESS RULES API (Puerto 3005)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Routes Layer                            â”‚ â”‚
â”‚  â”‚  /api/business-rules/*                                     â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  â€¢ /users/*          â€¢ /trips/*                           â”‚ â”‚
â”‚  â”‚  â€¢ /destinations/*   â€¢ /routes/*                          â”‚ â”‚
â”‚  â”‚  â€¢ /itineraries/*                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                â”‚
â”‚                               â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 Controllers Layer                         â”‚ â”‚
â”‚  â”‚  businessRulesController.js                               â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â€¢ validateUserRegistration                              â”‚ â”‚
â”‚  â”‚  â€¢ validateTripCreation                                  â”‚ â”‚
â”‚  â”‚  â€¢ generateItinerary                                     â”‚ â”‚
â”‚  â”‚  â€¢ calculateBudgetBreakdown                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                â”‚
â”‚                               â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Services Layer                           â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚ â”‚
â”‚  â”‚  â”‚ userBusinessRulesâ”‚  â”‚ tripBusinessRulesâ”‚             â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ validateEmail  â”‚  â”‚ â€¢ validateDates  â”‚             â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ validateRole   â”‚  â”‚ â€¢ calculateDur.  â”‚             â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚ â”‚
â”‚  â”‚  â”‚destinationBizRul.â”‚  â”‚ routeBusinessRul.â”‚             â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚ â”‚
â”‚  â”‚  â”‚â€¢ validateCoords  â”‚  â”‚ â€¢ validatePoints â”‚             â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚
â”‚  â”‚  â”‚   itineraryBusinessRules             â”‚                â”‚ â”‚
â”‚  â”‚  â”‚                                      â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ detectBudgetType()                â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ generateDailySchedule()           â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ calculateBudgetBreakdown()        â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ getActivityTemplates()            â”‚                â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Data Layer                             â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â€¢ Activity Templates (Cultura, Naturaleza, etc.)        â”‚ â”‚
â”‚  â”‚  â€¢ Budget Type Rules (EconÃ³mico, Medio, Alto)            â”‚ â”‚
â”‚  â”‚  â€¢ Schedule Templates                                    â”‚ â”‚
â”‚  â”‚  â€¢ Business Rules Constants                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Estructura de Directorios Completa

```
TravelBrain/
â”‚
â”œâ”€â”€ ğŸ“ business-rules-backend/         â† NUEVO SERVICIO
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ env.js
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â””â”€â”€ businessRulesController.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ businessRulesRoutes.js
â”‚   â”‚   â”œâ”€â”€ services/                  â† LÃ³gica de Negocio
â”‚   â”‚   â”‚   â”œâ”€â”€ userBusinessRules.js
â”‚   â”‚   â”‚   â”œâ”€â”€ tripBusinessRules.js
â”‚   â”‚   â”‚   â”œâ”€â”€ destinationBusinessRules.js
â”‚   â”‚   â”‚   â”œâ”€â”€ routeBusinessRules.js
â”‚   â”‚   â”‚   â””â”€â”€ itineraryBusinessRules.js
â”‚   â”‚   â”œâ”€â”€ app.js
â”‚   â”‚   â””â”€â”€ server.js
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ .env.example
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ ğŸ“ backend-project/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ businessRulesClient.js  â† NUEVO: Cliente HTTP
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ğŸ“ frontend-react/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ App.jsx
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ğŸ“„ docker-compose.yml              â† ACTUALIZADO: 3 servicios
â”œâ”€â”€ ğŸ“„ ARCHITECTURE.md                 â† NUEVO
â”œâ”€â”€ ğŸ“„ DEPLOYMENT.md                   â† NUEVO
â”œâ”€â”€ ğŸ“„ MIGRATION_SUMMARY.md            â† NUEVO
â”œâ”€â”€ ğŸ“„ README-NEW.md                   â† NUEVO
â”œâ”€â”€ ğŸ“„ DIAGRAMS.md                     â† NUEVO (este archivo)
â”œâ”€â”€ ğŸ”§ start-dev.sh                    â† NUEVO
â”œâ”€â”€ ğŸ”§ stop-dev.sh                     â† NUEVO
â””â”€â”€ ğŸ”§ start-dev.bat                   â† NUEVO
```

---

## ComparaciÃ³n: Antes vs DespuÃ©s

### ANTES (Arquitectura MonolÃ­tica)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FRONTEND                   â”‚
â”‚          (React)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BACKEND                    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Controllers                   â”‚  â”‚
â”‚  â”‚ (Todo incluido)               â”‚  â”‚
â”‚  â”‚ â€¢ CRUD                        â”‚  â”‚
â”‚  â”‚ â€¢ Validaciones                â”‚  â”‚
â”‚  â”‚ â€¢ Reglas de negocio           â”‚  â”‚
â”‚  â”‚ â€¢ CÃ¡lculos                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MongoDB                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Problemas:
âŒ CÃ³digo acoplado
âŒ DifÃ­cil de escalar
âŒ Testing complicado
âŒ Cambios en reglas afectan todo
```

### DESPUÃ‰S (Microservicios)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FRONTEND                   â”‚
â”‚          (React)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BACKEND API                â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Controllers                   â”‚  â”‚
â”‚  â”‚ â€¢ CRUD                        â”‚  â”‚
â”‚  â”‚ â€¢ AutenticaciÃ³n               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MongoDB                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    BUSINESS RULES API               â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Business Logic               â”‚  â”‚
â”‚  â”‚ â€¢ Validaciones               â”‚  â”‚
â”‚  â”‚ â€¢ Reglas de negocio          â”‚  â”‚
â”‚  â”‚ â€¢ CÃ¡lculos                   â”‚  â”‚
â”‚  â”‚ â€¢ GeneraciÃ³n de datos        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ventajas:
âœ… CÃ³digo desacoplado
âœ… FÃ¡cil de escalar
âœ… Testing simple
âœ… Cambios aislados
âœ… Reutilizable
```

---

## Diagrama de Despliegue Docker

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Compose Network                       â”‚
â”‚                   (travelbrain-network)                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Container: travelbrain-business-rules                   â”‚  â”‚
â”‚  â”‚  Image: business-rules-backend                           â”‚  â”‚
â”‚  â”‚  Port: 3005:3005                                         â”‚  â”‚
â”‚  â”‚  Status: Running                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â–²                                  â”‚
â”‚                              â”‚ Depends on                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Container: travelbrain-backend                          â”‚  â”‚
â”‚  â”‚  Image: backend-project                                  â”‚  â”‚
â”‚  â”‚  Port: 3004:3004                                         â”‚  â”‚
â”‚  â”‚  Status: Running                                         â”‚  â”‚
â”‚  â”‚  ENV: BUSINESS_RULES_API_URL=http://business-rules:3005 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â–²                                  â”‚
â”‚                              â”‚ Depends on                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Container: travelbrain-frontend                         â”‚  â”‚
â”‚  â”‚  Image: frontend-react                                   â”‚  â”‚
â”‚  â”‚  Port: 5173:5173                                         â”‚  â”‚
â”‚  â”‚  Status: Running                                         â”‚  â”‚
â”‚  â”‚  ENV: VITE_API_URL=http://localhost:3004                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Comandos:
â€¢ Iniciar: docker-compose up --build
â€¢ Detener: docker-compose down
â€¢ Ver logs: docker-compose logs -f
â€¢ Reiniciar: docker-compose restart
```

---

## Mapa de Reglas de Negocio

```
Business Rules API
â”‚
â”œâ”€â”€ ğŸ‘¤ User Rules (BR-USR-001 a BR-USR-008)
â”‚   â”œâ”€â”€ ValidaciÃ³n de email
â”‚   â”œâ”€â”€ NormalizaciÃ³n de email (lowercase)
â”‚   â”œâ”€â”€ ValidaciÃ³n de username (min 3 chars)
â”‚   â”œâ”€â”€ ValidaciÃ³n de password (min 6 chars)
â”‚   â”œâ”€â”€ Roles (ADMIN, REGISTERED, USER)
â”‚   â”œâ”€â”€ Estados (ACTIVE, INACTIVE)
â”‚   â””â”€â”€ Timezone (default: America/Guayaquil)
â”‚
â”œâ”€â”€ âœˆï¸ Trip Rules (BR-TRIP-001 a BR-TRIP-012)
â”‚   â”œâ”€â”€ ValidaciÃ³n de userId
â”‚   â”œâ”€â”€ ValidaciÃ³n de tÃ­tulo
â”‚   â”œâ”€â”€ ValidaciÃ³n de destino
â”‚   â”œâ”€â”€ ValidaciÃ³n de fechas
â”‚   â”œâ”€â”€ ValidaciÃ³n de presupuesto
â”‚   â”œâ”€â”€ CÃ¡lculo automÃ¡tico de duraciÃ³n
â”‚   â””â”€â”€ Ãndices de bÃºsqueda
â”‚
â”œâ”€â”€ ğŸ“ Destination Rules (BR-DEST-001 a BR-DEST-008)
â”‚   â”œâ”€â”€ ValidaciÃ³n de nombre
â”‚   â”œâ”€â”€ ValidaciÃ³n de paÃ­s
â”‚   â”œâ”€â”€ ValidaciÃ³n de coordenadas (lat, lng)
â”‚   â”œâ”€â”€ CÃ¡lculo de distancia (Haversine)
â”‚   â””â”€â”€ Ãndices geoespaciales
â”‚
â”œâ”€â”€ ğŸ›£ï¸ Route Rules (BR-ROUTE-001 a BR-ROUTE-008)
â”‚   â”œâ”€â”€ ValidaciÃ³n de userId
â”‚   â”œâ”€â”€ ValidaciÃ³n de nombre
â”‚   â”œâ”€â”€ ValidaciÃ³n de punto origen
â”‚   â”œâ”€â”€ ValidaciÃ³n de punto destino
â”‚   â”œâ”€â”€ ValidaciÃ³n de distancia
â”‚   â”œâ”€â”€ ValidaciÃ³n de duraciÃ³n
â”‚   â””â”€â”€ Modos de transporte (driving, walking, cycling, transit)
â”‚
â””â”€â”€ ğŸ“‹ Itinerary Rules
    â”œâ”€â”€ DetecciÃ³n de tipo de presupuesto
    â”‚   â”œâ”€â”€ < $100/dÃ­a: EconÃ³mico
    â”‚   â”œâ”€â”€ $100-$300/dÃ­a: Medio
    â”‚   â””â”€â”€ > $300/dÃ­a: Alto
    â”‚
    â”œâ”€â”€ Plantillas de actividades
    â”‚   â”œâ”€â”€ Cultura e Historia
    â”‚   â”œâ”€â”€ Naturaleza y Aventura
    â”‚   â”œâ”€â”€ GastronomÃ­a
    â”‚   â””â”€â”€ Deportes y Aventura
    â”‚
    â”œâ”€â”€ GeneraciÃ³n de horarios
    â”‚   â”œâ”€â”€ EconÃ³mico: 4 actividades/dÃ­a
    â”‚   â”œâ”€â”€ Medio: 5 actividades/dÃ­a
    â”‚   â””â”€â”€ Alto: 6 actividades/dÃ­a
    â”‚
    â””â”€â”€ DistribuciÃ³n de presupuesto
        â”œâ”€â”€ EconÃ³mico: 35% alojamiento, 30% comida, 20% actividades
        â”œâ”€â”€ Medio: 35% alojamiento, 25% comida, 25% actividades
        â””â”€â”€ Alto: 40% alojamiento, 20% comida, 30% actividades
```

---

Este documento proporciona una representaciÃ³n visual completa de la nueva arquitectura de TravelBrain.
